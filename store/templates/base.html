{% load static %}
{% get_media_prefix as MEDIA_URL %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}–ú–∞–≥–∞–∑–∏–Ω{% endblock %}</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#00ADB5',
              secondary: '#222831',
              accent: '#393E46'
            }
          }
        }
      }
    </script>
</head>

<body class="dark-theme">
    <!-- üß≠ NAVBAR -->
    <nav class="fixed top-0 left-0 w-full z-50 bg-accent p-4 flex justify-between items-center shadow-md">
      <a href="/" class="text-primary text-2xl font-bold">ShopZone</a>
      <ul class="flex space-x-6">
          <li><a href="/" class="hover:text-primary transition">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="/about/" class="hover:text-primary transition">–û –Ω–∞—Å</a></li>
          <li><a href="/contact/" class="hover:text-primary transition">–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏</a></li>
          <li><a href="/orders/" class="hover:text-primary transition">–ó–∞–∫–∞–∑—ã</a></li>
          <li><a href="/cart/" class="hover:text-primary transition">–ö–æ—Ä–∑–∏–Ω–∞</a></li>
          <li><a href="{% url 'store:sale_list' %}" class="hover:text-primary transition">–ê–∫—Ü–∏–∏</a></li>

          {% if user.is_authenticated %}
            <li><a href="{% url 'store:logout' %}" class="hover:text-primary transition">–í—ã–π—Ç–∏</a></li>
          {% else %}
            <li><a href="{% url 'store:login' %}" class="hover:text-primary transition">–í–æ–π—Ç–∏</a></li>
          {% endif %}
      </ul>
    </nav>

    <!-- üí¨ –°–û–û–ë–©–ï–ù–ò–Ø DJANGO -->
    {% if messages %}
      <div class="fixed top-4 right-4 z-50 space-y-2">
        {% for message in messages %}
          <div
            class="px-4 py-3 rounded-lg shadow-lg text-white transition transform duration-500 
                   {% if message.tags == 'success' %} bg-green-600
                   {% elif message.tags == 'error' %} bg-red-600
                   {% elif message.tags == 'warning' %} bg-yellow-500 text-gray-900
                   {% else %} bg-gray-700 {% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <!-- üì¶ –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
    <main class="min-h-screen mx-auto pt-24">

      {% if request.path == '/' or '/search' in request.path %}
      <!-- üîç –ü–æ–∏—Å–∫ -->
      <div class="bg-secondary/90 backdrop-blur-sm py-6 px-8 border-b border-gray-700 mb-10">
        <form method="get" action="{% url 'store:search_products' %}" 
              class="grid md:grid-cols-6 gap-4 items-end max-w-7xl mx-auto">

          <div class="md:col-span-2">
            <label class="block text-gray-400 text-sm mb-1 font-medium">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
            <input type="text" name="q" value="{{ request.GET.q }}" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ..."
                   class="w-full p-3 rounded-xl bg-accent/70 text-white placeholder-gray-500 focus:ring-2 focus:ring-primary outline-none transition">
          </div>

          <div>
            <label class="block text-gray-400 text-sm mb-1 font-medium">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
            <select name="category" class="w-full p-3 rounded-xl bg-accent/70 text-white focus:ring-2 focus:ring-primary outline-none transition">
              <option value="">–í—Å–µ</option>
              {% for c in categories %}
                <option value="{{ c.id }}" {% if selected_category == c.id %}selected{% endif %}>{{ c.name }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="flex gap-2">
            <div class="flex-1">
              <label class="block text-gray-400 text-sm mb-1 font-medium">–ú–∏–Ω. ‚Ç∏</label>
              <input type="number" step="0.01" name="min_price" value="{{ min_price }}" 
                     class="w-full p-3 rounded-xl bg-accent/70 text-white focus:ring-2 focus:ring-primary outline-none transition">
            </div>
            <div class="flex-1">
              <label class="block text-gray-400 text-sm mb-1 font-medium">–ú–∞–∫—Å. ‚Ç∏</label>
              <input type="number" step="0.01" name="max_price" value="{{ max_price }}" 
                     class="w-full p-3 rounded-xl bg-accent/70 text-white focus:ring-2 focus:ring-primary outline-none transition">
            </div>
          </div>

          <div class="flex items-center justify-center gap-2 bg-accent/70 rounded-xl p-3 hover:bg-accent transition">
            <input type="checkbox" name="has_discount" value="1" id="discount" class="w-4 h-4 accent-primary"
                   {% if has_discount == '1' %}checked{% endif %}>
            <label for="discount" class="text-gray-300 text-sm font-medium cursor-pointer">–°–æ —Å–∫–∏–¥–∫–æ–π</label>
          </div>

          <div>
            <button type="submit" class="w-full bg-primary hover:bg-teal-500 text-white font-semibold px-6 py-3 rounded-xl shadow-md transition transform hover:scale-105">
              –ù–∞–π—Ç–∏
            </button>
          </div>
        </form>
      </div>
      {% endif %}

      {% block content %}{% endblock %}
    </main>

    <!-- ü¶∂ FOOTER -->
    <footer class="bg-accent p-6 text-center text-gray-400 mt-8 border-t border-gray-700">
        <p>¬© 2025 ShopZone. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        <p class="text-sm mt-2">–°–¥–µ–ª–∞–Ω–æ –Ω–∞ Django –∏ TailwindCSS</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
